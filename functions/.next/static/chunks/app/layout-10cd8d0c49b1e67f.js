(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{101:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var r=a(4540);let n=()=>{let e=(0,r.d4)(e=>e.auth.user),t=(0,r.d4)(e=>e.auth.loading),a=!!e,n=(null==e?void 0:e.role)==="admin";return{user:e,isLoggedIn:a,isAdmin:n,loading:t}}},2218:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>d,NS:()=>l,n:()=>i,n2:()=>o});let r=(0,a(1990).Z0)({name:"ui",initialState:{modalOpen:!1,editingProduct:null,cartOpen:!1},reducers:{openModal(e,t){e.modalOpen=!0,e.editingProduct=t.payload||null},closeModal(e){e.modalOpen=!1,e.editingProduct=null},openCart(e){e.cartOpen=!0},closeCart(e){e.cartOpen=!1},toggleCart(e){e.cartOpen=!e.cartOpen}}}),{openModal:n,closeModal:s,openCart:o,closeCart:l,toggleCart:i}=r.actions,d=r.reducer},2491:e=>{e.exports={userControls:"UserControls_userControls___Hrf4"}},2811:e=>{e.exports={overlay:"auth-modal_overlay__gpQlL",modal:"auth-modal_modal__Rjot7",closeButton:"auth-modal_closeButton__b5iMJ",formArea:"auth-modal_formArea__kKetX",loginForm:"auth-modal_loginForm__fBnZY",formGroup:"auth-modal_formGroup__eCAn3",error:"auth-modal_error__Cpz_H",submitButton:"auth-modal_submitButton__qVEWI",switchMode:"auth-modal_switchMode__Eb9pO"}},4308:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Q});var r=a(5155),n=a(2115);a(6003);var s=a(6135),o=a.n(s),l=a(4540),i=a(1990),d=a(5551),c=a(9175),u=a(2218),m=a(8601),p=a(7409);let h=(0,i.U1)({reducer:{products:d.Ay,categories:c.A,ui:u.Ay,auth:m.Ay,cart:p.Ay}});function g(e){let{children:t}=e;return(0,r.jsx)(l.Kq,{store:h,children:t})}var x=a(6874),y=a.n(x),_=a(5695),j=a(6766),b=a(101),f=a(9911),v=a(5610),C=a(3004),N=a(5317);let w=()=>{let e=(0,l.wA)(),t=async e=>{try{let t=await (0,N.x7)((0,N.H9)(v.db,"users",e));if(t.exists())return t.data();return null}catch(e){return console.error("Error fetching user profile:",e),null}};return(0,n.useEffect)(()=>{let a=(0,C.hg)(v.j,async a=>{if(a){let r=await t(a.uid);r?e((0,m.gV)({uid:a.uid,...r})):e((0,m.gV)({uid:a.uid,email:a.email,role:"customer"}))}else e((0,m.lM)())});return()=>a()},[e]),{login:async(e,t)=>{await (0,C.x9)(v.j,e,t)},signup:async(e,t)=>{let a=(await (0,C.eJ)(v.j,e,t)).user;await (0,N.BN)((0,N.H9)(v.db,"users",a.uid),{uid:a.uid,email:a.email,role:"customer"})},logout:()=>{e((0,m.y4)())}}};var A=a(4932),S=a(2491),k=a.n(S);function P(){let e=(0,l.wA)(),t=(0,l.d4)(e=>e.auth.user),{logout:a}=w();return(0,r.jsxs)("div",{className:k().userControls,children:[(0,r.jsxs)(A.A,{variant:"primary",size:"s",children:[(0,r.jsx)(f.Cab,{}),"Contact Us"]}),(0,r.jsx)(A.A,{variant:"secondary",size:"s",onClick:()=>{e((0,u.n)())},children:(0,r.jsx)(f.AsH,{})}),t?(0,r.jsx)(A.A,{variant:"secondary",size:"s",onClick:a,children:(0,r.jsx)(f.axc,{})}):(0,r.jsx)(A.A,{variant:"secondary",size:"s",onClick:()=>{t||e((0,m.eK)("login"))},children:(0,r.jsx)(f.x$1,{})})]})}var I=a(9483),O=a.n(I);function B(){let e=(0,_.usePathname)(),{isAdmin:t}=(0,b.A)();return console.log("Redux user:",(0,l.d4)(e=>e.auth.user)),console.log("Header - isAdmin:",t),(0,r.jsx)("header",{className:O().header,children:(0,r.jsxs)("div",{className:O().container,children:[(0,r.jsxs)("div",{className:O().navContainer,children:[(0,r.jsx)(y(),{href:"/",className:O().logo,children:(0,r.jsx)(j.default,{src:"/fixmobile_logo.svg",alt:"FixMobile Logo",width:120,height:40,priority:!0})}),(0,r.jsxs)("nav",{className:O().nav,children:[(0,r.jsx)("a",{href:"https://serviss.fixmobile.lv/",className:O().navLink,target:"_blank",rel:"noopener noreferrer",children:"Serviss"}),(0,r.jsx)(y(),{href:"/shop",className:"".concat(O().navLink," ").concat("/shop"===e?O().active:""),children:"Shop"}),t&&(0,r.jsx)(y(),{href:"/admin",className:"".concat(O().navLink," ").concat("/admin"===e?O().active:""),children:"Admin"})]})]}),(0,r.jsx)(P,{})]})})}var H=a(2811),z=a.n(H);function D(){let{login:e}=w(),[t,a]=(0,n.useState)(""),[s,o]=(0,n.useState)(""),[l,i]=(0,n.useState)(null),[d,c]=(0,n.useState)(!1),u=async a=>{a.preventDefault(),i(null),c(!0);try{await e(t,s)}catch(e){i(e.message||"Login failed.")}finally{c(!1)}};return(0,r.jsxs)("form",{className:z().loginForm,onSubmit:u,children:[(0,r.jsxs)("div",{className:z().formGroup,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",value:t,onChange:e=>a(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:z().formGroup,children:[(0,r.jsx)("label",{children:"Password"}),(0,r.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),required:!0})]}),l&&(0,r.jsx)("div",{className:z().error,children:l}),(0,r.jsx)("button",{type:"submit",className:z().submitButton,disabled:d,children:d?"Logging in...":"Log In"})]})}let q=()=>{let{signup:e}=w(),[t,a]=(0,n.useState)(""),[s,o]=(0,n.useState)(""),[l,i]=(0,n.useState)(""),[d,c]=(0,n.useState)(null),[u,m]=(0,n.useState)(!1),p=async a=>{if(a.preventDefault(),c(null),s!==l)return void c("Passwords do not match.");m(!0);try{await e(t,s)}catch(e){c(e.message||"Signup failed.")}finally{m(!1)}};return(0,r.jsxs)("form",{className:z().loginForm,onSubmit:p,children:[(0,r.jsxs)("div",{className:z().formGroup,children:[(0,r.jsx)("label",{children:"Email"}),(0,r.jsx)("input",{type:"email",value:t,onChange:e=>a(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:z().formGroup,children:[(0,r.jsx)("label",{children:"Password"}),(0,r.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:z().formGroup,children:[(0,r.jsx)("label",{children:"Confirm Password"}),(0,r.jsx)("input",{type:"password",value:l,onChange:e=>i(e.target.value),required:!0})]}),d&&(0,r.jsx)("div",{className:z().error,children:d}),(0,r.jsx)("button",{type:"submit",className:z().submitButton,disabled:u,children:u?"Creating Account...":"Sign Up"})]})},M=()=>{let e=(0,l.wA)(),{modalOpen:t,mode:a}=(0,l.d4)(e=>e.auth),s=(0,l.d4)(e=>e.auth.user);if((0,n.useEffect)(()=>{s&&e((0,m.gs)())},[s,e]),!t)return null;let o=()=>e((0,m.Uh)());return(0,r.jsx)("div",{className:z().overlay,children:(0,r.jsxs)("div",{className:z().modal,children:[(0,r.jsx)("button",{className:z().closeButton,onClick:()=>e((0,m.gs)()),children:"\xd7"}),(0,r.jsx)("h2",{children:"login"===a?"Log In":"Sign Up"}),(0,r.jsx)("div",{className:z().formArea,children:"login"===a?(0,r.jsx)(D,{}):(0,r.jsx)(q,{})}),(0,r.jsx)("div",{className:z().switchMode,children:"login"===a?(0,r.jsxs)("p",{children:["Don't have an account?"," ",(0,r.jsx)("span",{onClick:o,children:"Sign Up"})]}):(0,r.jsxs)("p",{children:["Already have an account?"," ",(0,r.jsx)("span",{onClick:o,children:"Log In"})]})})]})})};var E=a(5870),F=a.n(E);let G=()=>{let e=(0,l.wA)(),t=(0,_.useRouter)(),{items:a,totalPrice:n}=(0,l.d4)(e=>e.cart),s=(0,l.d4)(e=>e.ui.cartOpen);return(0,r.jsxs)("div",{className:"".concat(F().cartDrawer," ").concat(s?F().open:F().closed),children:[(0,r.jsxs)("div",{className:"cart-header",style:{padding:"1rem",borderBottom:"1px solid #ddd"},children:[(0,r.jsx)("h2",{style:{margin:0},children:"Your Cart"}),(0,r.jsx)("button",{onClick:()=>e((0,u.NS)()),style:{float:"right",fontSize:"1.2rem"},children:"✕"})]}),(0,r.jsx)("div",{style:{flex:1,overflowY:"auto",padding:"1rem"},children:0===a.length?(0,r.jsx)("p",{children:"Your cart is empty."}):a.map(t=>(0,r.jsxs)("div",{style:{marginBottom:"1rem"},children:[(0,r.jsx)("strong",{children:t.name}),(0,r.jsxs)("p",{children:["€",t.price.toFixed(2)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{onClick:()=>e((0,p.CG)(t.productId)),children:"−"}),(0,r.jsx)("span",{style:{margin:"0 0.5rem"},children:t.quantity}),(0,r.jsx)("button",{onClick:()=>e((0,p.o7)(t.productId)),children:"+"}),(0,r.jsx)("button",{onClick:()=>e((0,p.dt)(t.productId)),style:{marginLeft:"1rem",color:"red"},children:"Remove"})]})]},t.productId))}),(0,r.jsxs)("div",{style:{padding:"1rem",borderTop:"1px solid #ddd"},children:[(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"1rem"},children:[(0,r.jsx)("span",{children:"Total:"}),(0,r.jsxs)("strong",{children:["€",n.toFixed(2)]})]}),(0,r.jsx)("button",{onClick:()=>{e((0,u.NS)()),t.push("/shop/checkout")},disabled:0===a.length,style:{width:"100%",padding:"0.75rem",background:"black",color:"white"},children:"Proceed to Checkout"})]})]})},L={title:"FixMobile",description:"Your trusted mobile repair and parts shop."};function U(){let e=(0,l.wA)(),t=(0,l.d4)(e=>e.cart);return(0,n.useEffect)(()=>{let t=localStorage.getItem("cart");if(t)try{let a=JSON.parse(t);e((0,p.Bo)(a))}catch(e){console.warn("Failed to parse cart:",e)}},[e]),(0,n.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(t))},[t]),null}function Q(e){let{children:t}=e,a=(0,_.usePathname)();return(0,n.useEffect)(()=>{window.scrollTo(0,0)},[a]),(0,r.jsxs)("html",{lang:"en",suppressHydrationWarning:!0,children:[(0,r.jsxs)("head",{children:[(0,r.jsx)("title",{children:L.title}),(0,r.jsx)("meta",{name:"description",content:L.description})]}),(0,r.jsx)("body",{className:"antialiased",children:(0,r.jsxs)(g,{children:[(0,r.jsx)(B,{}),(0,r.jsx)("main",{className:o().mainContent,children:t}),(0,r.jsx)(G,{}),(0,r.jsx)(U,{}),(0,r.jsx)(M,{})]})})]})}},4932:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(5155);a(2115);var n=a(8637),s=a.n(n),o=a(4972),l=a.n(o);function i(e){let{variant:t="primary",size:a="m",disabled:n=!1,icon:s=null,children:o=null,onClick:i}=e,d=[l().button,l()["button--".concat(t)],l()["button--".concat(a)],n?l()["button--disabled"]:""].filter(Boolean).join(" ");return(0,r.jsxs)("button",{className:d,onClick:i,disabled:n,children:[s&&(0,r.jsx)("span",{className:l().button__icon,children:s}),o&&(0,r.jsx)("span",{className:l().button__text,children:o})]})}i.propTypes={variant:s().oneOf(["primary","secondary"]),size:s().oneOf(["s","m","l"]),disabled:s().bool,icon:s().node,children:s().node,onClick:s().func},i.defaultProps={variant:"primary",size:"m",disabled:!1,icon:null,children:null,onClick:()=>{}}},4972:e=>{e.exports={button:"button_button__lmGUT","button--s":"button_button--s__cDdEm","button--m":"button_button--m__MQaM_","button--l":"button_button--l__PJNuo","button--primary":"button_button--primary__B5kZd","button--secondary":"button_button--secondary__L_jiz","button--disabled":"button_button--disabled__3AmQL"}},5551:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c,Bj:()=>l,DD:()=>d,j0:()=>o,vc:()=>i});var r=a(1990),n=a(5317),s=a(5610);let o=(0,r.zD)("products/fetchProducts",async()=>{let e=(await (0,n.GG)((0,n.rJ)(s.db,"Products"))).docs.map(e=>({id:e.id,...e.data()}));return console.log("✅ Products fetched from Firestore:",e),e}),l=(0,r.zD)("products/addProduct",async e=>({id:(await (0,n.gS)((0,n.rJ)(s.db,"Products"),e)).id,...e})),i=(0,r.zD)("products/updateProduct",async e=>{let{id:t,...a}=e,r=(0,n.H9)(s.db,"Products",t);return await (0,n.mZ)(r,a),e}),d=(0,r.zD)("products/deleteProduct",async e=>{let t=(0,n.H9)(s.db,"Products",e);return await (0,n.kd)(t),e}),c=(0,r.Z0)({name:"products",initialState:{items:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0,e.error=null}).addCase(o.fulfilled,(e,t)=>{e.loading=!1,e.items=t.payload}).addCase(o.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message}).addCase(l.fulfilled,(e,t)=>{e.items.push(t.payload)}).addCase(i.fulfilled,(e,t)=>{let a=e.items.findIndex(e=>e.id===t.payload.id);-1!==a&&(e.items[a]=t.payload)}).addCase(d.fulfilled,(e,t)=>{e.items=e.items.filter(e=>e.id!==t.payload)})}}).reducer},5610:(e,t,a)=>{"use strict";a.d(t,{db:()=>i,j:()=>d});var r=a(3915),n=a(5317),s=a(3004),o=a(858);let l=(0,r.Wp)({apiKey:"AIzaSyDKhEzFJi9HCHLVG_L3I4W8FtAT42dcuaU",authDomain:"mobile-6cc0b.firebaseapp.com",projectId:"mobile-6cc0b",storageBucket:"mobile-6cc0b.firebasestorage.app",messagingSenderId:"858564731564",appId:"1:858564731564:web:7116cb2c45b641501b3509"}),i=(0,n.aU)(l),d=(0,s.xI)(l);(0,o.c7)(l)},5870:e=>{e.exports={cartDrawer:"Cart_cartDrawer__j8xgk",open:"Cart_open__1e8ql",closed:"Cart_closed__Ikz13"}},6003:()=>{},6135:e=>{e.exports={layoutContainer:"layout_layoutContainer__JNMQ0",mainContent:"layout_mainContent__ssvon"}},7409:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>c,Bo:()=>n,CG:()=>i,bE:()=>s,dt:()=>o,o7:()=>l,sX:()=>d});let r=(0,a(1990).Z0)({name:"cart",initialState:{items:[],totalQuantity:0,totalPrice:0},reducers:{setCart:(e,t)=>t.payload,addToCart(e,t){let a=t.payload,r=e.items.find(e=>e.productId===a.id);if(r)r.quantity+=1;else{var n;e.items.push({productId:a.id,name:a.name,price:a.price,imageUrl:(null==(n=a.imageUrls)?void 0:n[0])||"",quantity:1})}e.totalQuantity+=1,e.totalPrice+=a.price},removeFromCart(e,t){let a=t.payload,r=e.items.find(e=>e.productId===a);r&&(e.totalQuantity-=r.quantity,e.totalPrice-=r.price*r.quantity,e.items=e.items.filter(e=>e.productId!==a))},increaseQuantity(e,t){let a=t.payload,r=e.items.find(e=>e.productId===a);r&&(r.quantity+=1,e.totalQuantity+=1,e.totalPrice+=r.price)},decreaseQuantity(e,t){let a=t.payload,n=e.items.find(e=>e.productId===a);n&&n.quantity>1?(n.quantity-=1,e.totalQuantity-=1,e.totalPrice-=n.price):r.caseReducers.removeFromCart(e,{payload:a})},clearCart(e){e.items=[],e.totalQuantity=0,e.totalPrice=0,localStorage.removeItem("cart")}}}),{setCart:n,addToCart:s,removeFromCart:o,increaseQuantity:l,decreaseQuantity:i,clearCart:d}=r.actions,c=r.reducer},7452:(e,t,a)=>{Promise.resolve().then(a.bind(a,4308))},8601:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>p,Uh:()=>c,eK:()=>i,gV:()=>u,gs:()=>d,lM:()=>m,y4:()=>h});var r=a(1990),n=a(7409),s=a(3004),o=a(5610);let l=(0,r.Z0)({name:"auth",initialState:{modalOpen:!1,mode:"login",user:null,loading:!0},reducers:{openAuthModal:(e,t)=>{e.modalOpen=!0,e.mode=t.payload||"login"},closeAuthModal:e=>{e.modalOpen=!1},toggleAuthMode:e=>{e.mode="login"===e.mode?"signup":"login"},setUser:(e,t)=>{e.user=t.payload,e.loading=!1},clearUser:e=>{e.user=null,e.loading=!1}}}),{openAuthModal:i,closeAuthModal:d,toggleAuthMode:c,setUser:u,clearUser:m}=l.actions,p=l.reducer,h=()=>async e=>{try{localStorage.removeItem("cart"),await (0,s.CI)(o.j),e((0,n.sX)()),e(m())}catch(e){console.error("Logout failed:",e)}}},9175:(e,t,a)=>{"use strict";a.d(t,{A:()=>l,j:()=>o});var r=a(1990),n=a(5317),s=a(5610);let o=(0,r.zD)("categories/fetchCategories",async()=>(await (0,n.GG)((0,n.rJ)(s.db,"Devices"))).docs.map(e=>({id:e.id,...e.data()}))),l=(0,r.Z0)({name:"categories",initialState:{items:[],loading:!1,error:null},reducers:{},extraReducers:e=>{e.addCase(o.pending,e=>{e.loading=!0,e.error=null}).addCase(o.fulfilled,(e,t)=>{e.loading=!1,e.items=t.payload}).addCase(o.rejected,(e,t)=>{e.loading=!1,e.error=t.error.message})}}).reducer},9483:e=>{e.exports={header:"Header_header__OYRYG",container:"Header_container__DjS6x",navContainer:"Header_navContainer__hjz2M",logo:"Header_logo__X4_yA",nav:"Header_nav__BVHdh",active:"Header_active__i2V1Y",userControls:"Header_userControls__qFFV5"}}},e=>{var t=t=>e(e.s=t);e.O(0,[191,836,992,156,711,835,540,990,874,829,441,684,358],()=>t(7452)),_N_E=e.O()}]);