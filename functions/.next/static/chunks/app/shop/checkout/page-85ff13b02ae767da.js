(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{1917:(e,t,a)=>{Promise.resolve().then(a.bind(a,7444))},2937:e=>{e.exports={checkoutGrid:"checkout_checkoutGrid___TeT6",formColumn:"checkout_formColumn__zxvy2",form:"checkout_form__YG4Wl",subtext:"checkout_subtext__T8sXS",nameRow:"checkout_nameRow__NzOWg",row:"checkout_row__1Ydw6",checkboxWrapper:"checkout_checkboxWrapper__u3FoR",cartSummary:"checkout_cartSummary__kErFj",total:"checkout_total__m0iiT",error:"checkout_error__X_Z5T"}},5610:(e,t,a)=>{"use strict";a.d(t,{db:()=>o,j:()=>c});var i=a(3915),r=a(5317),s=a(3004),l=a(858);let n=(0,i.Wp)({apiKey:"AIzaSyDKhEzFJi9HCHLVG_L3I4W8FtAT42dcuaU",authDomain:"mobile-6cc0b.firebaseapp.com",projectId:"mobile-6cc0b",storageBucket:"mobile-6cc0b.firebasestorage.app",messagingSenderId:"858564731564",appId:"1:858564731564:web:7116cb2c45b641501b3509"}),o=(0,r.aU)(n),c=(0,s.xI)(n);(0,l.c7)(n)},5695:(e,t,a)=>{"use strict";var i=a(8999);a.o(i,"usePathname")&&a.d(t,{usePathname:function(){return i.usePathname}}),a.o(i,"useRouter")&&a.d(t,{useRouter:function(){return i.useRouter}})},7409:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>d,Bo:()=>r,CG:()=>o,bE:()=>s,dt:()=>l,o7:()=>n,sX:()=>c});let i=(0,a(1990).Z0)({name:"cart",initialState:{items:[],totalQuantity:0,totalPrice:0},reducers:{setCart:(e,t)=>t.payload,addToCart(e,t){let a=t.payload,i=e.items.find(e=>e.productId===a.id);if(i)i.quantity+=1;else{var r;e.items.push({productId:a.id,name:a.name,price:a.price,imageUrl:(null==(r=a.imageUrls)?void 0:r[0])||"",quantity:1})}e.totalQuantity+=1,e.totalPrice+=a.price},removeFromCart(e,t){let a=t.payload,i=e.items.find(e=>e.productId===a);i&&(e.totalQuantity-=i.quantity,e.totalPrice-=i.price*i.quantity,e.items=e.items.filter(e=>e.productId!==a))},increaseQuantity(e,t){let a=t.payload,i=e.items.find(e=>e.productId===a);i&&(i.quantity+=1,e.totalQuantity+=1,e.totalPrice+=i.price)},decreaseQuantity(e,t){let a=t.payload,r=e.items.find(e=>e.productId===a);r&&r.quantity>1?(r.quantity-=1,e.totalQuantity-=1,e.totalPrice-=r.price):i.caseReducers.removeFromCart(e,{payload:a})},clearCart(e){e.items=[],e.totalQuantity=0,e.totalPrice=0,localStorage.removeItem("cart")}}}),{setCart:r,addToCart:s,removeFromCart:l,increaseQuantity:n,decreaseQuantity:o,clearCart:c}=i.actions,d=i.reducer},7444:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var i=a(5155),r=a(2115),s=a(4540),l=a(7409),n=a(5695),o=a(5317),c=a(5610),d=a(2937),u=a.n(d);function m(){let e=(0,s.wA)(),t=(0,n.useRouter)(),a=(0,s.d4)(e=>e.cart),d=(0,s.d4)(e=>e.auth.user),[m,p]=(0,r.useState)(!0),[h,y]=(0,r.useState)({firstName:"",lastName:"",email:"",phone:"",country:"Latvia",street:"",apartment:"",city:"",municipality:"",postalCode:"",shippingAddress:""}),[g,v]=(0,r.useState)(null),[x,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(d){var e;let[t,...a]=(null==(e=d.fullName)?void 0:e.split(" "))||[];y(e=>{var i,r,s,l;return{...e,firstName:t||"",lastName:(null==a?void 0:a.join(" "))||"",email:d.email||"",phone:d.phone||"",country:(null==(i=d.legal)?void 0:i.country)||"Latvia",street:(null==(r=d.legal)?void 0:r.street)||"",city:(null==(s=d.legal)?void 0:s.city)||"",postalCode:(null==(l=d.legal)?void 0:l.zip)||"",municipality:"",apartment:"",shippingAddress:_(d.delivery)}})}},[d]);let _=e=>e?"".concat(e.street,", ").concat(e.city,", ").concat(e.zip,", ").concat(e.country):"",j=e=>{let[t,a,i,r]=e.split(",").map(e=>e.trim());return{street:t,city:a,zip:i,country:r}},b=e=>{let{name:t,value:a}=e.target;y(e=>({...e,[t]:a}))},C=async i=>{if(i.preventDefault(),!h.firstName||!h.lastName||!h.email||!h.phone||!h.street||!h.city||!h.postalCode)return void v("Please fill in all required billing fields.");if(!m&&!h.shippingAddress)return void v('Please enter a delivery address or check "Same as billing address".');if(0===a.items.length)return void v("Your cart is empty.");let r={country:h.country,street:h.street,apartment:h.apartment,city:h.city,municipality:h.municipality,zip:h.postalCode},s=m?r:j(h.shippingAddress),n="".concat(h.firstName," ").concat(h.lastName);f(!0);try{await (0,o.gS)((0,o.rJ)(c.db,"orders"),{contactInfo:{name:n,email:h.email,phone:h.phone},legalAddress:r,deliveryAddress:s,items:a.items,totalPrice:a.totalPrice,createdAt:(0,o.O5)(),status:"pending"}),e((0,l.sX)()),t.push("/shop")}catch(e){console.error("Order submission failed:",e),v("Something went wrong. Please try again.")}finally{f(!1)}};return(0,i.jsxs)("div",{className:u().checkoutGrid,children:[(0,i.jsxs)("div",{className:u().formColumn,children:[(0,i.jsx)("h2",{children:"Contact Information"}),(0,i.jsx)("p",{className:u().subtext,children:"We’ll use this email to send you details and updates about your order."}),(0,i.jsxs)("form",{onSubmit:C,className:u().form,children:[(0,i.jsx)("input",{type:"email",name:"email",placeholder:"Email address",value:h.email,onChange:b}),(0,i.jsx)("h3",{children:"Billing address"}),(0,i.jsx)("select",{name:"country",value:h.country,onChange:b,children:(0,i.jsx)("option",{value:"Latvia",children:"Latvia"})}),(0,i.jsxs)("div",{className:u().nameRow,children:[(0,i.jsx)("input",{name:"firstName",placeholder:"First name",value:h.firstName,onChange:b}),(0,i.jsx)("input",{name:"lastName",placeholder:"Last name",value:h.lastName,onChange:b})]}),(0,i.jsx)("input",{name:"street",placeholder:"Address",value:h.street,onChange:b}),(0,i.jsx)("input",{name:"apartment",placeholder:"Apartment, suite, etc.",value:h.apartment,onChange:b}),(0,i.jsxs)("div",{className:u().row,children:[(0,i.jsx)("input",{name:"city",placeholder:"City",value:h.city,onChange:b}),(0,i.jsx)("input",{name:"municipality",placeholder:"Municipality (optional)",value:h.municipality,onChange:b})]}),(0,i.jsxs)("div",{className:u().row,children:[(0,i.jsx)("input",{name:"postalCode",placeholder:"Postal code",value:h.postalCode,onChange:b}),(0,i.jsx)("input",{name:"phone",placeholder:"Phone",value:h.phone,onChange:b})]}),(0,i.jsx)("h3",{children:"Shipping address"}),(0,i.jsxs)("div",{className:u().checkboxWrapper,children:[(0,i.jsx)("input",{id:"sameAsBilling",type:"checkbox",checked:m,onChange:()=>p(!m)}),(0,i.jsx)("label",{htmlFor:"sameAsBilling",children:"Same as billing address"})]}),!m&&(0,i.jsx)("textarea",{name:"shippingAddress",placeholder:"Shipping address (street, city, zip, country)",value:h.shippingAddress,onChange:b}),g&&(0,i.jsx)("p",{className:u().error,children:g}),(0,i.jsx)("button",{type:"submit",disabled:x,children:x?"Submitting...":"Place Order"})]})]}),(0,i.jsxs)("div",{className:u().cartSummary,children:[(0,i.jsx)("h2",{children:"Order summary"}),0===a.items.length?(0,i.jsx)("p",{children:"Your cart is empty."}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("ul",{children:a.items.map(e=>(0,i.jsxs)("li",{children:[e.name," \xd7 ",e.quantity," — €",(e.price*e.quantity).toFixed(2)]},e.productId))}),(0,i.jsxs)("p",{className:u().total,children:["Total: €",a.totalPrice.toFixed(2)]})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[590,992,156,835,540,990,441,684,358],()=>t(1917)),_N_E=e.O()}]);